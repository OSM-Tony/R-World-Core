<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>R-World Core â€” Command Line Interface Safe Mode</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <style>
        body { margin: 0; font-family: sans-serif; background-color: #f5f5f5; display: flex; flex-direction: column; height: 100vh; }
        #buttonBar { background: #222; padding: 5px; display: flex; gap: 10px; }
        #buttonBar button { background: #555; color: #fff; border: none; padding: 8px 12px; cursor: pointer; }
        #consoleOutput { flex: 1; font-size: 12px; color: #0a0; background: #111; padding: 10px; overflow-y: auto; }
        #commandLine { background: #333; padding: 5px; display: flex; }
        #commandLine input { flex: 1; padding: 8px; border: none; color: #fff; background: #444; }
        #commandLine button { padding: 8px; border: none; background: #555; color: #fff; cursor: pointer; }
    </style>
</head>
<body>
    <div id="buttonBar">
        <button id="toggleJsonBtn" onclick="toggleJsonLogging()">JSON Logging: ON</button>
    </div>
    <div id="consoleOutput"></div>
    <div id="commandLine">
        <input id="cmdInput" type="text" placeholder="Enter command here...">
        <button onclick="executeCommand()">Run</button>
    </div>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyCImKSrWlWkHBPZe1-g--jcl_xthZyORhI",
            authDomain: "r-world-core.firebaseapp.com",
            databaseURL: "https://r-world-core-default-rtdb.firebaseio.com",
            projectId: "r-world-core",
            storageBucket: "r-world-core.firebasestorage.app",
            messagingSenderId: "335093562897",
            appId: "1:335093562897:web:f2be99bb04eb06d2123bb0",
            measurementId: "G-ZMXF2QEBXQ"
        };

        let jsonLoggingEnabled = true;

        firebase.initializeApp(firebaseConfig);

        firebase.auth().signInWithEmailAndPassword('rworlddev@gmail.com', 'vancouverhl119!')
            .then(() => logToConsole('Signed in successfully.'))
            .catch((error) => logToConsole('Authentication error: ' + error.message));

        function logToConsole(msg) {
            const output = document.getElementById('consoleOutput');
            output.innerHTML += `> ${msg}<br>`;
            output.scrollTop = output.scrollHeight;
        }

        function executeCommand() {
            const input = document.getElementById('cmdInput').value;
            if (jsonLoggingEnabled) logToConsole('Received command: ' + input);
            try {
                const cmd = JSON.parse(input);
                if (cmd.path && (cmd.data !== undefined)) {
                    if (jsonLoggingEnabled) logToConsole(`Attempting to write to ${cmd.path}`);
                    firebase.database().ref(cmd.path).set(cmd.data).then(() => {
                        if (jsonLoggingEnabled) logToConsole('Database updated successfully at ' + cmd.path);
                    }).catch(err => {
                        logToConsole('Database write error: ' + err);
                    });
                } else {
                    logToConsole('Invalid command structure. JSON requires both path and data.');
                }
            } catch (e) {
                logToConsole('JSON parse error: ' + e);
            }
            document.getElementById('cmdInput').value = '';
        }

        function toggleJsonLogging() {
            jsonLoggingEnabled = !jsonLoggingEnabled;
            document.getElementById('toggleJsonBtn').innerText = `JSON Logging: ${jsonLoggingEnabled ? 'ON' : 'OFF'}`;
            logToConsole(`JSON logging turned ${jsonLoggingEnabled ? 'ON' : 'OFF'}.`);
        }

        document.getElementById('cmdInput').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') executeCommand();
        });
    </script>
</body>
</html>
